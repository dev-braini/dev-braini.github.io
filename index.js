(function(){function d(a,b){if(d.instance_)return d.instance_;d.instance_=this;this.outerContainerEl=document.querySelector(a);this.snackbarEl=this.containerEl=null;this.detailsButton=this.outerContainerEl.querySelector("#details-button");this.messageBox=document.querySelector("#messageBox");this.config=b||d.config;this.dimensions=d.defaultDimensions;this.distanceMeter=this.tRex=this.canvasCtx=this.canvas=null;this.runningTime=this.time=this.highestScore=this.distanceRan=0;this.msPerFrame=1E3/60;
    this.currentSpeed=this.config.SPEED;this.obstacles=[];this.inverted=this.paused=this.crashed=this.playing=this.activated=!1;this.invertTimer=0;this.resizeTimerId_=null;this.playCount=0;this.audioBuffer=null;this.soundFx={};this.bgMusic=this.audioContext=null;this.images={};this.imagesLoaded=0;this.isDisabled()?this.setupDisabledRunner():this.loadImages()}function p(a,b){return Math.floor(Math.random()*(b-a+1))+a}function F(a){var b=a.length/4*3;a=atob(a);var c=new ArrayBuffer(b);c=new Uint8Array(c);
    for(var e=0;e<b;e++)c[e]=a.charCodeAt(e);return c.buffer}function v(){return A?(new Date).getTime():performance.now()}function y(a,b,c,e){this.canvas=a;this.canvasCtx=a.getContext("2d");this.canvasDimensions=e;this.textImgPos=b;this.restartImgPos=c;this.draw()}function B(a,b){return new g(a.x+b.x,a.y+b.y,a.width,a.height)}function C(a,b){var c=!1,e=b.x;a.x<e+b.width&&a.x+a.width>e&&a.y<b.y+b.height&&a.height+a.y>b.y&&(c=!0);return c}function g(a,b,c,e){this.x=a;this.y=b;this.width=c;this.height=e}
    function r(a,b,c,e,f,l,m,u,w){this.canvasCtx=a;this.spritePos=e;this.typeConfig=b;this.gapCoefficient=l;this.size=c;this.dimensions=f;this.remove=!1;this.xPos=f.WIDTH+(u||0);this.width=this.yPos=0;this.collisionBoxes=[];this.timer=this.currentFrame=this.speedOffset=this.gap=0;this.init(m)}function h(a,b){this.canvas=a;this.canvasCtx=a.getContext("2d");this.spritePos=b;this.currentFrame=this.groundYPos=this.yPos=this.xPos=0;this.currentAnimFrames=[];this.timer=this.animStartTime=this.blinkCount=this.blinkDelay=
        0;this.msPerFrame=1E3/60;this.config=h.config;this.status=h.status.WAITING;this.ducking=this.jumping=!1;this.jumpVelocity=0;this.speedDrop=this.reachedMinHeight=!1;this.jumpspotX=this.jumpCount=0;this.init()}function n(a,b,c){this.canvas=a;this.canvasCtx=a.getContext("2d");this.image=d.imageSprite;this.spritePos=b;this.x=0;this.y=5;this.highScore=this.maxScore=this.currentDistance=0;this.container=null;this.digits=[];this.acheivement=!1;this.defaultString="";this.flashIterations=this.flashTimer=0;
        this.invertTrigger=!1;this.config=n.config;this.maxScoreUnits=this.config.MAX_DISTANCE_UNITS;this.init(c)}function q(a,b,c){this.canvas=a;this.canvasCtx=this.canvas.getContext("2d");this.spritePos=b;this.xPos=this.containerWidth=c;this.yPos=0;this.remove=!1;this.cloudGap=p(q.config.MIN_CLOUD_GAP,q.config.MAX_CLOUD_GAP);this.init()}function k(a,b,c){this.spritePos=b;this.canvas=a;this.canvasCtx=a.getContext("2d");this.xPos=c-50;this.yPos=30;this.opacity=this.currentPhase=0;this.containerWidth=c;this.stars=
        [];this.drawStars=!1;this.placeStars()}function t(a,b){this.spritePos=b;this.canvas=a;this.canvasCtx=a.getContext("2d");this.sourceDimensions={};this.dimensions=t.dimensions;this.sourceXPos=[this.spritePos.x,this.spritePos.x+this.dimensions.WIDTH];this.xPos=[];this.yPos=0;this.bumpThreshold=.5;this.setSourceDimensions();this.draw()}function z(a,b,c,e){this.canvas=a;this.canvasCtx=this.canvas.getContext("2d");this.config=z.config;this.dimensions=c;this.gapCoefficient=e;this.obstacles=[];this.obstacleHistory=
        [];this.horizonOffsets=[0,0];this.cloudFrequency=this.config.CLOUD_FREQUENCY;this.spritePos=b;this.nightMode=null;this.clouds=[];this.cloudSpeed=this.config.BG_CLOUD_SPEED;this.horizonLine=null;this.init()}window.Runner=d;var A=/iPad|iPhone|iPod/.test(window.navigator.platform),x=/Android/.test(window.navigator.userAgent)||A;d.config={ACCELERATION:.00131,BG_CLOUD_SPEED:.2,BOTTOM_PAD:10,CLEAR_TIME:3E3,CLOUD_FREQUENCY:.5,GAMEOVER_CLEAR_TIME:750,GAP_COEFFICIENT:.6,GRAVITY:.6,INITIAL_JUMP_VELOCITY:12,
        INVERT_FADE_DURATION:12E3,INVERT_DISTANCE:700,MAX_BLINK_COUNT:3,MAX_CLOUDS:6,MAX_OBSTACLE_LENGTH:10,MAX_OBSTACLE_DUPLICATION:2,MAX_SPEED:50,MIN_JUMP_HEIGHT:35,MOBILE_SPEED_COEFFICIENT:1.2,RESOURCE_TEMPLATE_ID:"audio-resources",SPEED:6.5,SPEED_DROP_COEFFICIENT:3,ARCADE_MODE_INITIAL_TOP_POSITION:35,ARCADE_MODE_TOP_POSITION_PERCENT:.1,BACKGROUND_MUSIC:"assets/soundtrack.mp3",BACKGROUND_MUSIC_VOLUME:.047};d.defaultDimensions={WIDTH:600,HEIGHT:150};d.classes={ARCADE_MODE:"arcade-mode",CANVAS:"runner-canvas",
        CONTAINER:"runner-container",CRASHED:"crashed",ICON:"icon-offline",INVERTED:"inverted",SNACKBAR:"snackbar",SNACKBAR_SHOW:"snackbar-show",TOUCH_CONTROLLER:"controller"};d.spriteDefinition={HDPI:{RESTART:{x:2,y:2},HORIZON:{x:2,y:104},CLOUD:{x:166,y:2},PTERODACTYL:{x:260,y:2},CACTUS_SMALL:{x:446,y:2},CACTUS_SMALL$2:{x:494,y:2},CACTUS_SMALL$3:{x:542,y:2},CACTUS_SMALL$4:{x:590,y:2},CACTUS_SMALL$5:{x:638,y:2},CACTUS_SMALL$6:{x:686,y:2},CACTUS_LARGE:{x:736,y:2},CACTUS_LARGE$2:{x:786,y:2},CACTUS_LARGE$3:{x:836,
                y:2},MOON:{x:1038,y:2},STAR:{x:1360,y:2},TEXT_SPRITE:{x:1378,y:2},TREX:{x:1762,y:2}}};d.sounds={BUTTON_PRESS:"offline-sound-press",HIT:"offline-sound-hit",SCORE:"offline-sound-reached"};d.keycodes={JUMP:{38:1,32:1},DUCK:{40:1},RESTART:{13:1}};d.events={ANIM_END:"webkitAnimationEnd",CLICK:"click",KEYDOWN:"keydown",KEYUP:"keyup",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",RESIZE:"resize",TOUCHEND:"touchend",TOUCHSTART:"touchstart",VISIBILITY:"visibilitychange",BLUR:"blur",FOCUS:"focus",LOAD:"load"};d.prototype=
        {isDisabled:function(){return!1},setupDisabledRunner:function(){this.containerEl=document.createElement("div");this.containerEl.className=d.classes.SNACKBAR;this.containerEl.textContent=loadTimeData.getValue("disabledEasterEgg");this.outerContainerEl.appendChild(this.containerEl);document.addEventListener(d.events.KEYDOWN,function(a){d.keycodes.JUMP[a.keyCode]&&(this.containerEl.classList.add(d.classes.SNACKBAR_SHOW),document.querySelector(".icon").classList.add("icon-disabled"))}.bind(this))},updateConfigSetting:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        b){if(a in this.config&&void 0!=b)switch(this.config[a]=b,a){case "GRAVITY":case "MIN_JUMP_HEIGHT":case "SPEED_DROP_COEFFICIENT":this.tRex.config[a]=b;break;case "INITIAL_JUMP_VELOCITY":this.tRex.setJumpVelocity(b);break;case "SPEED":this.setSpeed(b)}},loadImages:function(){d.imageSprite=document.getElementById("offline-resources-2x");this.spriteDef=d.spriteDefinition.HDPI;d.imageSprite.complete?this.init():d.imageSprite.addEventListener(d.events.LOAD,this.init.bind(this))},loadSounds:function(){if(!A){this.audioContext=
                new AudioContext;this.bgMusic=new Audio(this.config.BACKGROUND_MUSIC);this.bgMusic.volume=this.config.BACKGROUND_MUSIC_VOLUME;var a=document.getElementById(this.config.RESOURCE_TEMPLATE_ID).content,b;for(b in d.sounds){var c=a.getElementById(d.sounds[b]).src;c=c.substr(c.indexOf(",")+1);c=F(c);this.audioContext.decodeAudioData(c,function(e,f){this.soundFx[e]=f}.bind(this,b))}}},setSpeed:function(a){var b=a||this.currentSpeed;600>this.dimensions.WIDTH?(a=b*this.dimensions.WIDTH/600*this.config.MOBILE_SPEED_COEFFICIENT,
                this.currentSpeed=a>b?b:a):a&&(this.currentSpeed=a)},init:function(){document.querySelector("."+d.classes.ICON).style.visibility="hidden";this.adjustDimensions();this.setSpeed();this.containerEl=document.createElement("div");this.containerEl.className=d.classes.CONTAINER;var a=this.containerEl,b=this.dimensions.WIDTH,c=this.dimensions.HEIGHT,e=d.classes.PLAYER,f=document.createElement("canvas");f.className=e?d.classes.CANVAS+" "+e:d.classes.CANVAS;f.width=b;f.height=c;a.appendChild(f);this.canvas=
                f;this.canvasCtx=this.canvas.getContext("2d");this.canvasCtx.fillStyle="#f7f7f7";this.canvasCtx.fill();d.updateCanvasScaling(this.canvas);this.horizon=new z(this.canvas,this.spriteDef,this.dimensions,this.config.GAP_COEFFICIENT);this.distanceMeter=new n(this.canvas,this.spriteDef.TEXT_SPRITE,this.dimensions.WIDTH);this.tRex=new h(this.canvas,this.spriteDef.TREX);this.outerContainerEl.appendChild(this.containerEl);x&&this.createTouchController();this.startListening();this.update();window.addEventListener(d.events.RESIZE,
                this.debounceResize.bind(this))},createTouchController:function(){this.touchController=document.createElement("div");this.touchController.className=d.classes.TOUCH_CONTROLLER;this.outerContainerEl.appendChild(this.touchController)},debounceResize:function(){this.resizeTimerId_||(this.resizeTimerId_=setInterval(this.adjustDimensions.bind(this),250))},adjustDimensions:function(){clearInterval(this.resizeTimerId_);this.resizeTimerId_=null;var a=window.getComputedStyle(this.outerContainerEl);a=Number(a.paddingLeft.substr(0,
                a.paddingLeft.length-2));this.dimensions.WIDTH=this.outerContainerEl.offsetWidth-2*a;this.dimensions.WIDTH=Math.min(600,this.dimensions.WIDTH);this.canvas&&(this.canvas.width=this.dimensions.WIDTH,this.canvas.height=this.dimensions.HEIGHT,d.updateCanvasScaling(this.canvas),this.distanceMeter.calcXPos(this.dimensions.WIDTH),this.clearCanvas(),this.horizon.update(0,0,!0),this.tRex.update(0),this.playing||this.crashed||this.paused?(this.containerEl.style.width=this.dimensions.WIDTH+"px",this.containerEl.style.height=
                this.dimensions.HEIGHT+"px",this.distanceMeter.update(0,Math.ceil(this.distanceRan)),this.stop()):this.tRex.draw(0,0),this.crashed&&this.gameOverPanel&&(this.gameOverPanel.updateDimensions(this.dimensions.WIDTH),this.gameOverPanel.draw()))},playIntro:function(){if(this.activated||this.crashed)this.crashed&&this.restart();else{this.playingIntro=!0;this.tRex.playingIntro=!0;var a="@-webkit-keyframes intro { from { width:"+h.config.WIDTH+"px }to { width: "+this.dimensions.WIDTH+"px }}",b=document.createElement("style");
                b.innerHTML=a;document.head.appendChild(b);this.containerEl.addEventListener(d.events.ANIM_END,this.startGame.bind(this));this.containerEl.style.webkitAnimation="intro .4s ease-out 1 both";this.containerEl.style.width=this.dimensions.WIDTH+"px";this.activated=this.playing=!0}},startGame:function(){this.runningTime=100;this.playingIntro=!1;this.tRex.playingIntro=!1;this.containerEl.style.webkitAnimation="";this.playCount++;document.addEventListener(d.events.VISIBILITY,this.onVisibilityChange.bind(this));
                window.addEventListener(d.events.BLUR,this.onVisibilityChange.bind(this));window.addEventListener(d.events.FOCUS,this.onVisibilityChange.bind(this))},clearCanvas:function(){this.canvasCtx.clearRect(0,0,this.dimensions.WIDTH,this.dimensions.HEIGHT)},update:function(){this.updatePending=!1;var a=v(),b=a-(this.time||a);this.time=a;if(this.playing){this.clearCanvas();this.tRex.jumping&&this.tRex.updateJump(b);this.runningTime+=b;a=this.runningTime>this.config.CLEAR_TIME;1!=this.tRex.jumpCount||this.playingIntro||
            this.playIntro();this.playingIntro?this.horizon.update(0,this.currentSpeed,a):(b=this.activated?b:0,this.horizon.update(b,this.currentSpeed,a,this.inverted));if(a)a:{var c=this.horizon.obstacles[0],e=this.tRex;a=new g(e.xPos+1,e.yPos+1,e.config.WIDTH-2,e.config.HEIGHT-2);var f=new g(c.xPos+1,c.yPos+1,c.typeConfig.width*c.size-2,c.typeConfig.height-2);if(C(a,f)){c=c.collisionBoxes;e=e.ducking?h.collisionBoxes.DUCKING:h.collisionBoxes.RUNNING;for(var l=0;l<e.length;l++)for(var m=0;m<c.length;m++){var u=
                B(e[l],a),w=B(c[m],f);if(C(u,w)){a=[u,w];break a}}}a=!1}a?this.gameOver():(this.distanceRan+=this.currentSpeed*b/this.msPerFrame,this.currentSpeed<this.config.MAX_SPEED&&(this.currentSpeed+=this.config.ACCELERATION));this.distanceMeter.update(b,Math.ceil(this.distanceRan))&&this.playSound(this.soundFx.SCORE);this.invertTimer>this.config.INVERT_FADE_DURATION?(this.invertTimer=0,this.invertTrigger=!1,this.invert()):this.invertTimer?this.invertTimer+=b:(a=this.distanceMeter.getActualDistance(Math.ceil(this.distanceRan)),
            0<a&&(this.invertTrigger=!(a%this.config.INVERT_DISTANCE))&&0===this.invertTimer&&(this.invertTimer+=b,this.invert()))}if(this.playing||!this.activated&&this.tRex.blinkCount<d.config.MAX_BLINK_COUNT)this.tRex.update(b),this.scheduleNextUpdate()},handleEvent:function(a){var b=d.events;switch(a.type){case b.KEYDOWN:case b.TOUCHSTART:case b.MOUSEDOWN:this.onKeyDown(a);break;case b.KEYUP:case b.TOUCHEND:case b.MOUSEUP:this.onKeyUp(a)}},startListening:function(){document.addEventListener(d.events.KEYDOWN,
                this);document.addEventListener(d.events.KEYUP,this);x?(this.touchController.addEventListener(d.events.TOUCHSTART,this),this.touchController.addEventListener(d.events.TOUCHEND,this),this.containerEl.addEventListener(d.events.TOUCHSTART,this)):(document.addEventListener(d.events.MOUSEDOWN,this),document.addEventListener(d.events.MOUSEUP,this))},stopListening:function(){document.removeEventListener(d.events.KEYDOWN,this);document.removeEventListener(d.events.KEYUP,this);x?(this.touchController.removeEventListener(d.events.TOUCHSTART,
                this),this.touchController.removeEventListener(d.events.TOUCHEND,this),this.containerEl.removeEventListener(d.events.TOUCHSTART,this)):(document.removeEventListener(d.events.MOUSEDOWN,this),document.removeEventListener(d.events.MOUSEUP,this))},onKeyDown:function(a){x&&this.playing&&a.preventDefault();a.target!=this.detailsButton&&(this.crashed||!d.keycodes.JUMP[a.keyCode]&&a.type!=d.events.TOUCHSTART&&a.type!=d.events.MOUSEDOWN||(this.playing||(hideStartScreen(),showRank(h.config.INTRO_DURATION),
                this.loadSounds(),this.playing=!0,this.bgMusic.play(),this.update(),window.errorPageController&&errorPageController.trackEasterEgg()),this.tRex.jumping||this.tRex.ducking||(this.playSound(this.soundFx.BUTTON_PRESS),this.tRex.startJump(this.currentSpeed))),this.crashed&&a.type==d.events.TOUCHSTART&&a.currentTarget==this.containerEl&&this.restart());this.playing&&!this.crashed&&d.keycodes.DUCK[a.keyCode]&&(a.preventDefault(),this.tRex.jumping?this.tRex.setSpeedDrop():this.tRex.jumping||this.tRex.ducking||
                this.tRex.setDuck(!0))},onKeyUp:function(a){var b=String(a.keyCode),c=d.keycodes.JUMP[b]||a.type==d.events.TOUCHEND||a.type==d.events.MOUSEDOWN;this.isRunning()&&c?this.tRex.endJump():d.keycodes.DUCK[b]?(this.tRex.speedDrop=!1,this.tRex.setDuck(!1)):this.crashed?(c=v()-this.time,(d.keycodes.RESTART[b]||this.isLeftClickOnCanvas(a)||c>=this.config.GAMEOVER_CLEAR_TIME&&d.keycodes.JUMP[b])&&this.restart()):this.paused&&c&&(this.tRex.reset(),this.play())},isLeftClickOnCanvas:function(a){return null!=a.button&&
                2>a.button&&a.type==d.events.MOUSEUP&&a.target==this.canvas},scheduleNextUpdate:function(){this.updatePending||(this.updatePending=!0,this.raqId=requestAnimationFrame(this.update.bind(this)))},isRunning:function(){return!!this.raqId},gameOver:function(){this.playSound(this.soundFx.HIT);x&&window.navigator.vibrate&&window.navigator.vibrate(200);this.bgMusic.pause();this.stop();this.crashed=!0;this.distanceMeter.acheivement=!1;this.tRex.update(100,h.status.CRASHED);this.gameOverPanel?this.gameOverPanel.draw():
                this.gameOverPanel=new y(this.canvas,this.spriteDef.TEXT_SPRITE,this.spriteDef.RESTART,this.dimensions);this.distanceRan>this.highestScore&&(this.highestScore=Math.ceil(this.distanceRan),this.distanceMeter.setHighScore(this.highestScore));this.time=v()},stop:function(){this.playing=!1;this.paused=!0;cancelAnimationFrame(this.raqId);this.raqId=0},play:function(){this.crashed||(this.playing=!0,this.paused=!1,this.tRex.update(0,h.status.RUNNING),this.time=v(),this.update())},restart:function(){this.raqId||
            (this.playCount++,this.runningTime=0,this.playing=!0,this.crashed=!1,this.distanceRan=0,this.setSpeed(this.config.SPEED),this.time=v(),this.containerEl.classList.remove(d.classes.CRASHED),this.clearCanvas(),this.distanceMeter.reset(this.highestScore),this.horizon.reset(),this.tRex.reset(),this.playSound(this.soundFx.BUTTON_PRESS),this.bgMusic.currentTime=0,this.bgMusic.play(),this.invert(!0),this.update())},setArcadeMode:function(){document.body.classList.add(d.classes.ARCADE_MODE);this.setArcadeModeContainerScale()},
            setArcadeModeContainerScale:function(){var a=window.innerHeight,b=Math.max(1,Math.min(a/this.dimensions.HEIGHT,window.innerWidth/this.dimensions.WIDTH));this.containerEl.style.transform="scale("+b+") translateY("+Math.ceil(Math.max(0,(a-this.dimensions.HEIGHT*b-d.config.ARCADE_MODE_INITIAL_TOP_POSITION)*d.config.ARCADE_MODE_TOP_POSITION_PERCENT))*window.devicePixelRatio+"px)"},onVisibilityChange:function(a){document.hidden||document.webkitHidden||"blur"==a.type||"visible"!=document.visibilityState?
                this.stop():this.crashed||(this.tRex.reset(),this.play())},playSound:function(a){if(a){var b=this.audioContext.createBufferSource();b.buffer=a;b.connect(this.audioContext.destination);b.start(0)}},invert:function(a){a?(document.body.classList.toggle(d.classes.INVERTED,!1),this.invertTimer=0,this.inverted=!1):this.inverted=document.body.classList.toggle(d.classes.INVERTED,this.invertTrigger)}};d.updateCanvasScaling=function(a,b,c){var e=a.getContext("2d"),f=Math.floor(window.devicePixelRatio)||1,l=
        Math.floor(e.webkitBackingStorePixelRatio)||1,m=f/l;if(f!==l)return b=b||a.width,c=c||a.height,a.width=b*m,a.height=c*m,a.style.width=b+"px",a.style.height=c+"px",e.scale(m,m),!0;1==f&&(a.style.width=a.width+"px",a.style.height=a.height+"px");return!1};y.dimensions={TEXT_X:0,TEXT_Y:13,TEXT_WIDTH:191,TEXT_HEIGHT:11,RESTART_WIDTH:36,RESTART_HEIGHT:32};y.prototype={updateDimensions:function(a,b){this.canvasDimensions.WIDTH=a;b&&(this.canvasDimensions.HEIGHT=b)},draw:function(){var a=y.dimensions,b=this.canvasDimensions.WIDTH/
            2,c=a.TEXT_X,e=a.TEXT_Y,f=a.TEXT_WIDTH,l=a.TEXT_HEIGHT,m=Math.round(b-a.TEXT_WIDTH/2),u=Math.round((this.canvasDimensions.HEIGHT-25)/3),w=a.TEXT_WIDTH,G=a.TEXT_HEIGHT,D=a.RESTART_WIDTH,E=a.RESTART_HEIGHT;b-=a.RESTART_WIDTH/2;var H=this.canvasDimensions.HEIGHT/2;D*=2;E*=2;c=2*c+this.textImgPos.x;e=2*e+this.textImgPos.y;this.canvasCtx.drawImage(d.imageSprite,c,e,2*f,2*l,m,u,w,G);this.canvasCtx.drawImage(d.imageSprite,this.restartImgPos.x,this.restartImgPos.y,D,E,b,H,a.RESTART_WIDTH,a.RESTART_HEIGHT)}};
    r.MAX_GAP_COEFFICIENT=1.5;r.MAX_OBSTACLE_LENGTH=3;r.prototype={init:function(a){this.cloneCollisionBoxes();1<this.size&&this.typeConfig.multipleSpeed>a&&(this.size=1);this.width=this.typeConfig.width*this.size;if(Array.isArray(this.typeConfig.yPos)){var b=x?this.typeConfig.yPosMobile:this.typeConfig.yPos;this.yPos=b[p(0,b.length-1)]}else this.yPos=this.typeConfig.yPos;this.draw();1<this.size&&(this.collisionBoxes[1].width=this.width-this.collisionBoxes[0].width-this.collisionBoxes[2].width,this.collisionBoxes[2].x=
            this.width-this.collisionBoxes[2].width);this.typeConfig.speedOffset&&(this.speedOffset=.5<Math.random()?this.typeConfig.speedOffset:-this.typeConfig.speedOffset);this.gap=this.getGap(this.gapCoefficient,a)},draw:function(){var a=this.typeConfig.width,b=this.typeConfig.height;a*=2;var c=a*this.size*.5*(this.size-1)+this.spritePos.x;0<this.currentFrame&&(c+=a*this.currentFrame);this.canvasCtx.drawImage(d.imageSprite,c,this.spritePos.y,a*this.size,2*b,this.xPos,this.yPos,this.typeConfig.width*this.size,
            this.typeConfig.height)},update:function(a,b){this.remove||(this.typeConfig.speedOffset&&(b+=this.speedOffset),this.xPos-=Math.floor(60*b/1E3*a),this.typeConfig.numFrames&&(this.timer+=a,this.timer>=this.typeConfig.frameRate&&(this.currentFrame=this.currentFrame==this.typeConfig.numFrames-1?0:this.currentFrame+1,this.timer=0)),this.draw(),this.isVisible()||(this.remove=!0))},getGap:function(a,b){var c=Math.round(this.width*b+this.typeConfig.minGap*a);return p(c,Math.round(c*r.MAX_GAP_COEFFICIENT))},
        isVisible:function(){return 0<this.xPos+this.width},cloneCollisionBoxes:function(){for(var a=this.typeConfig.collisionBoxes,b=a.length-1;0<=b;b--)this.collisionBoxes[b]=new g(a[b].x,a[b].y,a[b].width,a[b].height)}};r.types=[{type:"CACTUS_SMALL",width:24,height:35,maxSize:3,yPos:105,multipleSpeed:4,minGap:120,minSpeed:0,collisionBoxes:[new g(0,7,5,27),new g(4,0,6,34),new g(10,4,7,14)]},{type:"CACTUS_SMALL$2",width:24,height:35,maxSize:1,yPos:105,multipleSpeed:4,minGap:120,minSpeed:0,collisionBoxes:[new g(0,
            7,5,27),new g(4,0,6,34),new g(10,4,7,14)]},{type:"CACTUS_SMALL$3",width:24,height:35,maxSize:1,yPos:105,multipleSpeed:4,minGap:120,minSpeed:0,collisionBoxes:[new g(0,7,5,27),new g(4,0,6,34),new g(10,4,7,14)]},{type:"CACTUS_SMALL$4",width:24,height:35,maxSize:1,yPos:105,multipleSpeed:4,minGap:120,minSpeed:0,collisionBoxes:[new g(0,7,5,27),new g(4,0,6,34),new g(10,4,7,14)]},{type:"CACTUS_SMALL$5",width:24,height:35,maxSize:1,yPos:105,multipleSpeed:4,minGap:120,minSpeed:0,collisionBoxes:[new g(0,7,5,
            27),new g(4,0,6,34),new g(10,4,7,14)]},{type:"CACTUS_SMALL$6",width:24,height:35,maxSize:1,yPos:105,multipleSpeed:4,minGap:120,minSpeed:0,collisionBoxes:[new g(0,7,5,27),new g(4,0,6,34),new g(10,4,7,14)]},{type:"CACTUS_LARGE",width:25,height:50,maxSize:3,yPos:90,multipleSpeed:7,minGap:120,minSpeed:0,collisionBoxes:[new g(0,12,7,38),new g(8,0,7,49),new g(13,10,10,38)]},{type:"CACTUS_LARGE$2",width:25,height:50,maxSize:1,yPos:90,multipleSpeed:7,minGap:120,minSpeed:0,collisionBoxes:[new g(0,12,7,38),
            new g(8,0,7,49),new g(13,10,10,38)]},{type:"CACTUS_LARGE$3",width:25,height:50,maxSize:1,yPos:90,multipleSpeed:7,minGap:120,minSpeed:0,collisionBoxes:[new g(0,12,7,38),new g(8,0,7,49),new g(13,10,10,38)]}];h.config={DROP_VELOCITY:-5,GRAVITY:.6,HEIGHT:47,HEIGHT_DUCK:25,INIITAL_JUMP_VELOCITY:-10,INTRO_DURATION:1500,MAX_JUMP_HEIGHT:30,MIN_JUMP_HEIGHT:30,SPEED_DROP_COEFFICIENT:3,SPRITE_WIDTH:262,START_X_POS:50,WIDTH:44,WIDTH_DUCK:59};h.collisionBoxes={DUCKING:[new g(1,18,55,25)],RUNNING:[new g(22,0,17,
            16),new g(1,18,30,9),new g(10,35,14,8),new g(1,24,29,5),new g(5,30,21,4),new g(9,34,15,4)]};h.status={CRASHED:"CRASHED",DUCKING:"DUCKING",JUMPING:"JUMPING",RUNNING:"RUNNING",WAITING:"WAITING"};h.BLINK_TIMING=7E3;h.animFrames={WAITING:{frames:[44,0],msPerFrame:1E3/3},RUNNING:{frames:[88,132],msPerFrame:1E3/12},CRASHED:{frames:[220],msPerFrame:1E3/60},JUMPING:{frames:[0],msPerFrame:1E3/60},DUCKING:{frames:[264,323],msPerFrame:125}};h.prototype={init:function(){this.yPos=this.groundYPos=d.defaultDimensions.HEIGHT-
            this.config.HEIGHT-d.config.BOTTOM_PAD;this.minJumpHeight=this.groundYPos-this.config.MIN_JUMP_HEIGHT;this.draw(0,0);this.update(0,h.status.WAITING)},setJumpVelocity:function(a){this.config.INIITAL_JUMP_VELOCITY=-a;this.config.DROP_VELOCITY=-a/2},update:function(a,b){this.timer+=a;b&&(this.status=b,this.currentFrame=0,this.msPerFrame=h.animFrames[b].msPerFrame,this.currentAnimFrames=h.animFrames[b].frames,b==h.status.WAITING&&(this.animStartTime=v(),this.setBlinkDelay()));this.playingIntro&&this.xPos<
        this.config.START_X_POS&&(this.xPos+=Math.round(this.config.START_X_POS/this.config.INTRO_DURATION*a));this.status==h.status.WAITING?this.blink(v()):this.draw(this.currentAnimFrames[this.currentFrame],0);this.timer>=this.msPerFrame&&(this.currentFrame=this.currentFrame==this.currentAnimFrames.length-1?0:this.currentFrame+1,this.timer=0);this.speedDrop&&this.yPos==this.groundYPos&&(this.speedDrop=!1,this.setDuck(!0))},draw:function(a,b){var c=this.ducking&&this.status!=h.status.CRASHED?this.config.WIDTH_DUCK:
            this.config.WIDTH,e=this.config.HEIGHT;var f=2*a;var l=2*b;c*=2;e*=2;f+=this.spritePos.x;l+=this.spritePos.y;this.ducking&&this.status!=h.status.CRASHED?this.canvasCtx.drawImage(d.imageSprite,f,l,c,e,this.xPos,this.yPos,this.config.WIDTH_DUCK,this.config.HEIGHT):(this.ducking&&this.status==h.status.CRASHED&&this.xPos++,this.canvasCtx.drawImage(d.imageSprite,f,l,c,e,this.xPos,this.yPos,this.config.WIDTH,this.config.HEIGHT))},setBlinkDelay:function(){this.blinkDelay=Math.ceil(Math.random()*h.BLINK_TIMING)},
        blink:function(a){a-this.animStartTime>=this.blinkDelay&&(this.draw(this.currentAnimFrames[this.currentFrame],0),1==this.currentFrame&&(this.setBlinkDelay(),this.animStartTime=a,this.blinkCount++))},startJump:function(a){this.jumping||(this.update(0,h.status.JUMPING),this.jumpVelocity=this.config.INIITAL_JUMP_VELOCITY-a/10,this.jumping=!0,this.speedDrop=this.reachedMinHeight=!1)},endJump:function(){this.reachedMinHeight&&this.jumpVelocity<this.config.DROP_VELOCITY&&(this.jumpVelocity=this.config.DROP_VELOCITY)},
        updateJump:function(a,b){var c=a/h.animFrames[this.status].msPerFrame;this.yPos=this.speedDrop?this.yPos+Math.round(this.jumpVelocity*this.config.SPEED_DROP_COEFFICIENT*c):this.yPos+Math.round(this.jumpVelocity*c);this.jumpVelocity+=this.config.GRAVITY*c;if(this.yPos<this.minJumpHeight||this.speedDrop)this.reachedMinHeight=!0;(this.yPos<this.config.MAX_JUMP_HEIGHT||this.speedDrop)&&this.endJump();this.yPos>this.groundYPos&&(this.reset(),this.jumpCount++);this.update(a)},setSpeedDrop:function(){this.speedDrop=
            !0;this.jumpVelocity=1},setDuck:function(a){a&&this.status!=h.status.DUCKING?(this.update(0,h.status.DUCKING),this.ducking=!0):this.status==h.status.DUCKING&&(this.update(0,h.status.RUNNING),this.ducking=!1)},reset:function(){this.yPos=this.groundYPos;this.jumpVelocity=0;this.ducking=this.jumping=!1;this.update(0,h.status.RUNNING);this.speedDrop=this.midair=!1;this.jumpCount=0}};n.dimensions={WIDTH:10,HEIGHT:13,DEST_WIDTH:11};n.yPos=[0,13,27,40,53,67,80,93,107,120];n.config={MAX_DISTANCE_UNITS:5,
        ACHIEVEMENT_DISTANCE:300,COEFFICIENT:.025,FLASH_DURATION:250,FLASH_ITERATIONS:3};n.prototype={init:function(a){this.rankValue=document.querySelector("#rank-value");this.rankLabel=document.querySelector("#rank-label");var b="";this.calcXPos(a);this.maxScore=this.maxScoreUnits;for(a=0;a<this.maxScoreUnits;a++)this.draw(a,0),this.defaultString+="0",b+="9";this.maxScore=parseInt(b)},calcXPos:function(a){this.x=a-n.dimensions.DEST_WIDTH*(this.maxScoreUnits+1)},draw:function(a,b,c){var e=n.dimensions.WIDTH,
            f=n.dimensions.HEIGHT;b*=n.dimensions.WIDTH;var l=a*n.dimensions.DEST_WIDTH,m=this.y,u=n.dimensions.WIDTH,w=n.dimensions.HEIGHT;e*=2;f*=2;b=2*b+this.spritePos.x;a=0+this.spritePos.y;this.canvasCtx.save();c?this.canvasCtx.translate(this.x-2*this.maxScoreUnits*n.dimensions.WIDTH,this.y):this.canvasCtx.translate(this.x,this.y);this.canvasCtx.drawImage(this.image,b,a,e,f,l,m,u,w);this.canvasCtx.restore()},getActualDistance:function(a){return a?Math.round(a*this.config.COEFFICIENT):0},setRank:function(a){var b=
            "RECRUIT",c=this.rankValue.innerText,e=this.rankLabel.innerText="rank",f=this.config.ACHIEVEMENT_DISTANCE,l=this.rankValue.classList;a>=8*f?(e="jump on",b="You are a monster!"):a>=7*f?(e="jump on",b="INSANE"):a>=6*f?(e="jump on",b="AWESOME"):a>=4*f?(e="",b='<span class="green">CONGRATULATIONS!<br />Claim your quest on crew3.</span>'):a>=3*f?b="LIEUTENANT":a>=2*f?b="1st OFFICER":a>=f&&(b="2nd OFFICER");this.rankLabel.innerText=e;this.rankValue.innerHTML=b;0<a&&c!=b&&(l.add("bounce"),setTimeout(function(){l.remove("bounce")},
            2500))},update:function(a,b){var c=!0,e=!1;this.acheivement?(this.setRank(this.getActualDistance(b)),this.flashIterations<=this.config.FLASH_ITERATIONS?(this.flashTimer+=a,this.flashTimer<this.config.FLASH_DURATION?c=!1:this.flashTimer>2*this.config.FLASH_DURATION&&(this.flashTimer=0,this.flashIterations++)):(this.acheivement=!1,this.flashTimer=this.flashIterations=0)):(b=this.getActualDistance(b),b>this.maxScore&&this.maxScoreUnits==this.config.MAX_DISTANCE_UNITS?(this.maxScoreUnits++,this.maxScore=
            parseInt(this.maxScore+"9")):this.distance=0,0<b?(0==b%this.config.ACHIEVEMENT_DISTANCE&&(this.acheivement=!0,this.flashTimer=0,e=!0),this.digits=(this.defaultString+b).substr(-this.maxScoreUnits).split("")):this.digits=this.defaultString.split(""));if(c)for(c=this.digits.length-1;0<=c;c--)this.draw(c,parseInt(this.digits[c]));this.drawHighScore();return e},drawHighScore:function(){this.canvasCtx.save();this.canvasCtx.globalAlpha=.8;for(var a=this.highScore.length-1;0<=a;a--)this.draw(a,parseInt(this.highScore[a],
            10),!0);this.canvasCtx.restore()},setHighScore:function(a){a=this.getActualDistance(a);a=(this.defaultString+a).substr(-this.maxScoreUnits);this.highScore=["10","11",""].concat(a.split(""))},reset:function(){this.update(0);this.setRank(0);this.acheivement=!1}};q.config={HEIGHT:14,MAX_CLOUD_GAP:400,MAX_SKY_LEVEL:30,MIN_CLOUD_GAP:100,MIN_SKY_LEVEL:71,WIDTH:46};q.prototype={init:function(){this.yPos=p(q.config.MAX_SKY_LEVEL,q.config.MIN_SKY_LEVEL);this.draw()},draw:function(){this.canvasCtx.save();var a=
            q.config.WIDTH,b=q.config.HEIGHT;this.canvasCtx.drawImage(d.imageSprite,this.spritePos.x,this.spritePos.y,2*a,2*b,this.xPos,this.yPos,q.config.WIDTH,q.config.HEIGHT);this.canvasCtx.restore()},update:function(a){this.remove||(this.xPos-=Math.ceil(a),this.draw(),this.isVisible()||(this.remove=!0))},isVisible:function(){return 0<this.xPos+q.config.WIDTH}};k.config={FADE_SPEED:.035,HEIGHT:40,MOON_SPEED:.25,NUM_STARS:2,STAR_SIZE:9,STAR_SPEED:.3,STAR_MAX_Y:70,WIDTH:20};k.phases=[140,120,100,60,40,20,0];
    k.prototype={update:function(a,b){a&&0==this.opacity&&(this.currentPhase++,this.currentPhase>=k.phases.length&&(this.currentPhase=0));a&&(1>this.opacity||0==this.opacity)?this.opacity+=k.config.FADE_SPEED:0<this.opacity&&(this.opacity-=k.config.FADE_SPEED);if(0<this.opacity){this.xPos=this.updateXPos(this.xPos,k.config.MOON_SPEED);if(this.drawStars)for(var c=0;c<k.config.NUM_STARS;c++)this.stars[c].x=this.updateXPos(this.stars[c].x,k.config.STAR_SPEED);this.draw()}else this.opacity=0,this.placeStars();
            this.drawStars=!0},updateXPos:function(a,b){return a=a<-k.config.WIDTH?this.containerWidth:a-b},draw:function(){var a=3==this.currentPhase?2*k.config.WIDTH:k.config.WIDTH,b=k.config.HEIGHT,c=a,e=k.config.STAR_SIZE;a*=2;b*=2;var f=this.spritePos.x+2*k.phases[this.currentPhase];e*=2;var l=d.spriteDefinition.HDPI.STAR.x;this.canvasCtx.save();this.canvasCtx.globalAlpha=this.opacity;if(this.drawStars)for(var m=0;m<k.config.NUM_STARS;m++)this.canvasCtx.drawImage(d.imageSprite,l,this.stars[m].sourceY,e,
            e,Math.round(this.stars[m].x),this.stars[m].y,k.config.STAR_SIZE,k.config.STAR_SIZE);this.canvasCtx.drawImage(d.imageSprite,f,this.spritePos.y,a,b,Math.round(this.xPos),this.yPos,c,k.config.HEIGHT);this.canvasCtx.globalAlpha=1;this.canvasCtx.restore()},placeStars:function(){for(var a=Math.round(this.containerWidth/k.config.NUM_STARS),b=0;b<k.config.NUM_STARS;b++)this.stars[b]={},this.stars[b].x=p(a*b,a*(b+1)),this.stars[b].y=p(0,k.config.STAR_MAX_Y),this.stars[b].sourceY=d.spriteDefinition.HDPI.STAR.y+
            2*k.config.STAR_SIZE*b},reset:function(){this.opacity=this.currentPhase=0;this.update(!1)}};t.dimensions={WIDTH:600,HEIGHT:12,YPOS:127};t.prototype={setSourceDimensions:function(){for(var a in t.dimensions)"YPOS"!=a&&(this.sourceDimensions[a]=2*t.dimensions[a]),this.dimensions[a]=t.dimensions[a];this.xPos=[0,t.dimensions.WIDTH];this.yPos=t.dimensions.YPOS},getRandomType:function(){return Math.random()>this.bumpThreshold?this.dimensions.WIDTH:0},draw:function(){this.canvasCtx.drawImage(d.imageSprite,
            this.sourceXPos[0],this.spritePos.y,this.sourceDimensions.WIDTH,this.sourceDimensions.HEIGHT,this.xPos[0],this.yPos,this.dimensions.WIDTH,this.dimensions.HEIGHT);this.canvasCtx.drawImage(d.imageSprite,this.sourceXPos[1],this.spritePos.y,this.sourceDimensions.WIDTH,this.sourceDimensions.HEIGHT,this.xPos[1],this.yPos,this.dimensions.WIDTH,this.dimensions.HEIGHT)},updateXPos:function(a,b){var c=0==a?1:0;this.xPos[a]-=b;this.xPos[c]=this.xPos[a]+this.dimensions.WIDTH;this.xPos[a]<=-this.dimensions.WIDTH&&
        (this.xPos[a]+=2*this.dimensions.WIDTH,this.xPos[c]=this.xPos[a]-this.dimensions.WIDTH,this.sourceXPos[a]=this.getRandomType()+this.spritePos.x)},update:function(a,b){var c=Math.floor(.06*b*a);0>=this.xPos[0]?this.updateXPos(0,c):this.updateXPos(1,c);this.draw()},reset:function(){this.xPos[0]=0;this.xPos[1]=t.dimensions.WIDTH}};z.config={BG_CLOUD_SPEED:.2,BUMPY_THRESHOLD:.3,CLOUD_FREQUENCY:.5,HORIZON_HEIGHT:16,MAX_CLOUDS:6};z.prototype={init:function(){this.addCloud();this.horizonLine=new t(this.canvas,
            this.spritePos.HORIZON);this.nightMode=new k(this.canvas,this.spritePos.MOON,this.dimensions.WIDTH)},update:function(a,b,c,e){this.runningTime+=a;this.horizonLine.update(a,b);this.nightMode.update(e);this.updateClouds(a,b);c&&this.updateObstacles(a,b)},updateClouds:function(a,b){var c=this.cloudSpeed/1E3*a*b,e=this.clouds.length;if(e){for(var f=e-1;0<=f;f--)this.clouds[f].update(c);c=this.clouds[e-1];e<this.config.MAX_CLOUDS&&this.dimensions.WIDTH-c.xPos>c.cloudGap&&this.cloudFrequency>Math.random()&&
        this.addCloud();this.clouds=this.clouds.filter(function(l){return!l.remove})}else this.addCloud()},updateObstacles:function(a,b){for(var c=this.obstacles.slice(0),e=0;e<this.obstacles.length;e++){var f=this.obstacles[e];f.update(a,b);f.remove&&c.shift()}this.obstacles=c;0<this.obstacles.length?(c=this.obstacles[this.obstacles.length-1])&&!c.followingObstacleCreated&&c.isVisible()&&c.xPos+c.width+c.gap<this.dimensions.WIDTH&&(this.addNewObstacle(b),c.followingObstacleCreated=!0):this.addNewObstacle(b)},
        removeFirstObstacle:function(){this.obstacles.shift()},addNewObstacle:function(a){var b=p(0,r.types.length-1),c=r.types[b];b=p(1,r.MAX_OBSTACLE_LENGTH);if(1<b&&1===c.maxSize){var e=c.type.split("$")[0];r.types.forEach(function(f){f.type===e&&(c=f)})}this.duplicateObstacleCheck(c.type)||a<c.minSpeed?this.addNewObstacle(a):(this.obstacles.push(new r(this.canvasCtx,c,b,this.spritePos[c.type],this.dimensions,this.gapCoefficient,a,c.width)),this.obstacleHistory.unshift(c.type),1<this.obstacleHistory.length&&
        this.obstacleHistory.splice(d.config.MAX_OBSTACLE_DUPLICATION))},duplicateObstacleCheck:function(a){for(var b=0,c=0;c<this.obstacleHistory.length;c++)b=this.obstacleHistory[c]==a?b+1:0;return b>=d.config.MAX_OBSTACLE_DUPLICATION},reset:function(){this.obstacles=[];this.horizonLine.reset();this.nightMode.reset()},resize:function(a,b){this.canvas.width=a;this.canvas.height=b},addCloud:function(){this.clouds.push(new q(this.canvas,this.spritePos.CLOUD,this.dimensions.WIDTH))}}})();
function hideStartScreen(){var d=document.querySelector("#messageBox"),p=document.querySelector("#logo");d.classList.add("hide");p.classList.add("hide")}function showRank(d){var p=document.querySelector("#rank-wrapper");setTimeout(function(){p.style.visibility="visible"},d-550)}function onDocumentLoad(){this.runner=new Runner(".interstitial-wrapper")}document.addEventListener("DOMContentLoaded",onDocumentLoad);
